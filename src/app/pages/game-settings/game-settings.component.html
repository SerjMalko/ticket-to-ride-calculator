<form nz-form [formGroup]="gameForm">

  <div class="player-info" formArrayName="playerInfos">

    <nz-form-item *ngFor="let control of playerInfoList.controls; let i=index">
      <div [formGroupName]="i">
        <nz-form-label [nzXs]="24" [nzSm]="4" *ngIf="i == 0"
        >Players
        </nz-form-label>
        <nz-form-control
          [nzXs]="24"
          [nzSm]="20"
          [nzOffset]="i == 0 ? 0 : 4"
          nzErrorTip="Please input name's value or delete this field."
        >
          <ng-container class="player-info__player-element" [formGroupName]="'player'">
            <input
              *ngIf="!gameTime"
              class="player-name"
              nz-input
              placeholder="placeholder"
              [formControlName]="'name'"
            />
            <span *ngIf="gameTime">{{control.value?.player?.name}}</span>

            <nz-select class="player-color"
                       *ngIf="!gameTime"
                       [formControlName]="'colorTrains'"
                       nzAllowClear
                       nzPlaceHolder="Choose"
                       (ngModelChange)="reInitColorList()"
                       [nzCustomTemplate]="custom">

              <nz-option *ngFor="let option of listOfColorTrain"

                         nzCustomContent
                         [nzLabel]="option.label"
                         [nzValue]="option.value">
                <i class="train-color-item color-{{option.value}}"></i>
                <span>{{option.label}}</span>
              </nz-option>
            </nz-select>
            <ng-template #custom let-selected>
              <i class="train-color-item color-{{selected.nzValue}}"></i>
              <span>{{selected.nzValue}}</span>
            </ng-template>

            <ng-container *ngIf="gameTime">
              <ng-container
                *ngTemplateOutlet="custom;context:{$implicit: {nzValue: control.value?.player?.colorTrains}}">
              </ng-container>
            </ng-container>

          </ng-container>


          <i nz-icon *ngIf="playerInfoList.length > MIN_PLAYER && !gameTime"
             nzType="minus-circle-o"
             class="dynamic-delete-button"
             (click)="removePlayerInfo(i)"></i>

          <button nz-button nzType="dashed" *ngIf="gameTime"  (click)="calcResult(control)">
            <i nz-icon nzType="plus"></i>
            Add result
          </button>
        </nz-form-control>
      </div>

    </nz-form-item>
    <nz-form-item *ngIf="playerInfoList.length < MAX_PLAYER && !gameTime">
      <nz-form-control [nzXs]="{ span: 24, offset: 0 }" [nzSm]="{ span: 20, offset: 4 }">
        <button nz-button nzType="dashed" class="add-button" (click)="addPlayerInfo($event)">
          <i nz-icon nzType="plus"></i>
          Add player
        </button>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item *ngIf="!gameTime">
      <nz-form-control [nzXs]="{ span: 24, offset: 0 }" [nzSm]="{ span: 20, offset: 4 }">
        <button nz-button nzType="primary" (click)="submitGameForm()">Start</button>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item *ngIf="gameTime">
      <nz-form-control [nzXs]="{ span: 24, offset: 0 }" [nzSm]="{ span: 20, offset: 4 }">
        <button nz-button nzType="primary" (click)="finishGame()">Finish</button>
      </nz-form-control>
    </nz-form-item>


  </div>


</form>






